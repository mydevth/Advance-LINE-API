"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),r=require("@liff/consts"),t=require("@liff/util"),o=require("@liff/logger"),n={};function i(){return n}function s(r,t){var o=i(),n=e.__read(t.split("."),1)[0],s=o[t];s&&r.removeEventListener(n,s),o[t]=null}var f=!1,a=!1;function c(r,t,o,i){f||(a=function(){var e=!1;try{var r=Object.defineProperty({},"passive",{get:function(){return e=!0,!1}});window.addEventListener("test",r,r),window.removeEventListener("test",r,r)}catch(t){e=!1}return e}(),f=!0);var c=e.__read(t.split("."),1)[0];return new Promise((function(e){var f=function(n){e(n),o&&o(n),i&&i.once&&s(r,t)};!function(e,r){n[e]=r}(t,f),r.addEventListener(c,f,!!a&&i)}))}exports.listen=c,exports.messageReceive=function(e,r,t,n){c(e,"message."+r,function(e,r,t){return function(n){o.logger.debug("messageReceive",n),n.origin===t&&n.data.name===e&&r(n)}}(r,t,n))},exports.messageTell=function(e,o,n,i){if(void 0===n&&(n={}),"object"!=typeof e||!e.postMessage)throw t.createLiffError(r.INVALID_ARGUMENT,"target must be window object");if("string"!=typeof o)throw t.createLiffError(r.INVALID_ARGUMENT,"keyname must be string");if("object"!=typeof n)throw t.createLiffError(r.INVALID_ARGUMENT,"incorrect body format. It should be Object or Array comprised of Object");if(!i)throw t.createLiffError(r.INVALID_ARGUMENT,"serverEndPointUrl isn't passed. please fill up with proper url");if("*"===i)throw new Error("serverEndPointUrl doesn't allow to set '*'");var s={name:o,body:n};e.postMessage(s,i)},exports.removeListen=s;
