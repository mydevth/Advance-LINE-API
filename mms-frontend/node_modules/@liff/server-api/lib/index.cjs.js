"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("@liff/consts"),r=require("@liff/util"),a=require("@liff/store");function n(a){return e.__awaiter(this,void 0,void 0,(function(){var n,i,s;return e.__generator(this,(function(e){switch(e.label){case 0:if(!a.ok)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,a.json()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,a];case 4:return n=String(a.status),i=r.HTTPStatusCodes.has(n)?n:t.UNKNOWN,[4,a.json().catch((function(){throw r.createLiffError(i,a.statusText)}))];case 5:throw s=e.sent(),r.createLiffError(s.error||i,s.error_description||s.message)}}))}))}function i(n){var i=function(e){if(e)return e;var n=a.getAccessToken();if(!n)throw r.createLiffError(t.UNAUTHORIZED,"Need access_token for api call, Please login first");return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+n}}(n&&n.headers);return e.__assign(e.__assign({},n),{headers:i})}function s(e,t){var r;try{r=i(t)}catch(a){return Promise.reject(a)}return fetch(e,r).then(n)}function o(e){var t=e.subdomain;return"https://"+(void 0===t?"api":t)+".line.me/"+e.pathname}var u={token:o({pathname:"oauth2/v2.1/token"}),certs:o({pathname:"oauth2/v2.1/certs"}),"openid-configuration":o({subdomain:"access",pathname:".well-known/openid-configuration"}),authorize:o({subdomain:"access",pathname:"liff/v1/authorize"}),profile:o({pathname:"v2/profile"}),message:o({pathname:"message/v3/share"}),friendship:o({pathname:"friendship/v1/status"}),shareTargetPicker:o({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker"}),shareTargetPickerOtt:o({pathname:"liff/v2/apps"}),shareTargetPickerResult:o({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker/result"}),apps:o({pathname:"liff/v2/apps"}),subWindowGetMSIT:o({pathname:"liff/v2/sub/msit"}),subWindowGetMSTByMSIT:o({pathname:"liff/v2/sub/mst"}),subWindowSubscribe:o({subdomain:"liff",pathname:"liff/v2/sub/waitResult"}),subWindowPost:o({pathname:"liff/v2/sub/result"}),subWindowGetAppData:o({pathname:"liff/v2/sub/appData"}),subWindowGetOrigin:function(e){return o({pathname:"liff/v2/sub/"+e+"/origin"})},accessTokenVerify:o({pathname:"oauth2/v2.1/verify"}),unauthorizedPermissions:o({subdomain:"liff",pathname:"liff/v2/incrementalAgreement/unauthorizedPermissions"}),permanentLink:o({subdomain:"liff",pathname:"liff/v2/permanentLink"})};function c(e){return u[e]}exports.fetch=s,exports.getEndPoint=c,exports.requestWithoutErrorHandling=function(e,t){var r;try{r=i(t)}catch(a){return Promise.reject(a)}return fetch(e,r)},exports.verifyAccessToken=function(e){return s(c("accessTokenVerify")+"?access_token="+encodeURIComponent(e),{headers:{"Content-Type":"application/json",Accept:"application/json"}})};
