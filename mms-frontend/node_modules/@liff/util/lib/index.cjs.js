"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@liff/logger"),e=require("tslib"),t=require("@liff/consts");function n(r){return window.atob(r.replace(/-/g,"+").replace(/_/g,"/"))}var o={decode:n,encode:function(r){return window.btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},decodeUnicode:function(r){var e=n(r).split("").map((function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)})).join("");return decodeURIComponent(e)}};function i(r){return parseInt(r,16)}var a={get:function(r){var e=new RegExp("(?:(?:^|.*;\\s*)"+r+"\\s*\\=\\s*([^;]*).*$)|^.*$");return document.cookie.replace(e,"$1")},set:function(e,t,n){var o=e+"="+t;if(n)for(var i in n){o+="; "+i+(n[i]?"="+n[i]:"")}r.logger.debug("set cookie",o),document.cookie=o},remove:function(r,e){var t=r+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT";if(e)for(var n in e)t+="; "+n+"="+e[n];document.cookie=t}},c=new Set(["400","401","403","404","429","500"]),u=function(r){function t(e,t){var n=r.call(this,t)||this;return n.code=e,n}return e.__extends(t,r),t}(Error);var s=new(function(){function r(){this.map={}}return r.prototype.clear=function(){this.map={}},r.prototype.getItem=function(r){var e=this.map[r];return void 0===e?null:e},r.prototype.setItem=function(r,e){this.map[r]=e},r.prototype.removeItem=function(r){delete this.map[r]},r.prototype.key=function(r){var e=Object.keys(this.map)[r];return void 0===e?null:e},Object.defineProperty(r.prototype,"length",{get:function(){return Object.keys(this.map).length},enumerable:!1,configurable:!0}),r}());var f={parse:function(r){return r.replace(/^\?/,"").replace(/^#\/?/,"").split(/&+/).filter((function(r){return r.length>0})).reduce((function(r,t){var n=e.__read(t.split("=").map(decodeURIComponent),2),o=n[0],i=n[1],a=r[o];return Array.isArray(a)?a.push(i):Object.prototype.hasOwnProperty.call(r,o)?r[o]=[a,i]:r[o]=i,r}),{})},stringify:function(r){return Object.keys(r).map((function(e){var t=r[e],n=function(r){return void 0!==r?encodeURIComponent(e)+"="+encodeURIComponent(r):encodeURIComponent(e)};return Array.isArray(t)?t.map((function(r){return n(r)})).join("&"):n(t)})).join("&")}},p="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function l(){return window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967296}function d(r){var e=new URL(r),n=e.hash.slice(1).split("&").filter((function(r){return!t.CREDENTIAL_KEYS.some((function(e){return r.includes(e+"=")}))})).join("&");return e.hash=n,e.toString()}function v(r){var t=new URL(r);return t.toString().replace(new RegExp(String.raw(g||(g=e.__makeTemplateObject(["^",""],["^",""])),t.origin)),"")}var g;exports.HTTPStatusCodes=c,exports.LiffError=u,exports.addParamsToUrl=function(r,t){if(!r)throw new Error("addParamsToUrl: invalid URL");var n=new URL(r);return Object.entries(t).forEach((function(r){var t=e.__read(r,2),o=t[0],i=t[1];n.searchParams.set(o,i)})),n.toString()},exports.base64Url=o,exports.compareVersion=function(r,e){if(r===e)return 0;for(var t=r.split("."),n=e.split("."),o=Math.max(t.length,n.length),i=0;i<o;i++){t[i]||(t[i]="0"),n[i]||(n[i]="0");var a=parseInt(t[i])-parseInt(n[i]);if(0!==a)return a>0?1:-1}return 0},exports.convertArgbToRgba=function(e){var t=e.replace("#","").match(/.{2}/g)||[];if(4!==t.length)return r.logger.warn("convertArgbToRgba: Received invalid ARGB color"),"";var n=function(r){var e=i(r);return Math.round(e/255*100)/100}(t[0]);return"rgba("+i(t[1])+", "+i(t[2])+", "+i(t[3])+", "+n+")"},exports.convertArrayBuffer=function(r){for(var e=r.length,t=new ArrayBuffer(e),n=new Uint8Array(t),o=0;o<e;o++)n[o]=r.charCodeAt(o);return t},exports.convertHexToRgb=function(e){var t=e.replace("#","").match(/.{2}/g)||[];return 3!==t.length?(r.logger.warn("convertArgbToRgba: Received invalid hex color"),""):i(t[0])+", "+i(t[1])+", "+i(t[2])},exports.cookie=a,exports.createLiffError=function(r,e){return new u(r,e||"")},exports.extractChannelIdFromLiffId=function(r){var e=r.match(/([^-]+)-[^-]+/);return e&&e[1]},exports.extractLiffId=function(r){var e,n,o=r.match((n=t.PERMANENT_LINK_ORIGIN,e=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),new RegExp("^"+e+"(\\d+-\\w+)")));return o&&o[1]},exports.getOriginOfUrl=function(r){var e=r.match(/^(https?:\/\/.*?)\//);return e&&e[1]||""},exports.getRandomValue=l,exports.hexToBase64=function(r){var e="";return r.replace(/\r|\n/g,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ").forEach((function(r){e+=String.fromCharCode(parseInt(r))})),window.btoa(e)},exports.inMemoryStorage=s,exports.isIE=function(r){void 0===r&&(r=window.navigator.userAgent);var e=r.toLowerCase();return-1!==e.indexOf("msie")||-1!==e.indexOf("trident")},exports.isIpad=function(r){return void 0===r&&(r=window.navigator.userAgent),/ipad/.test(r.toLowerCase())},exports.isLIFFBrowser=function(r){return void 0===r&&(r=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+ LIFF/.test(r)},exports.isLINEBrowser=function(r){return void 0===r&&(r=window.navigator.userAgent),/Line\/\d+\.\d+\.\d+/.test(r)},exports.isSubWindow=function(r){return void 0===r&&(r=window.navigator.userAgent),/LIFF\/SubWindow/.test(r)},exports.objectAssignKeyOnlyWithValue=function(r){for(var t,n,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var a=function(e){Object.keys(e).filter((function(r){return null!==e[r]&&void 0!==e[r]})).forEach((function(t){r[t]=e[t]}))};try{for(var c=e.__values(o),u=c.next();!u.done;u=c.next()){var s=u.value;a(s)}}catch(f){t={error:f}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return r},exports.qs=f,exports.randomAlphaNumericString=function(r){for(var e="",t=0;t<r;t++)e+=p[Math.floor(l()*p.length)];return e},exports.removeCredential=d,exports.removeOrigin=v,exports.replaceUrlCredentialRemoved=function(r){var e=v(d(r));window.history.replaceState(history.state,"",e)};
