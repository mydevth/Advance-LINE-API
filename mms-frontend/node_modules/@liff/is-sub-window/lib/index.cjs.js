"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@liff/consts"),t=require("@liff/util"),i=require("@liff/store"),n=require("@liff/is-in-client"),r=function(){function e(){}return e.prototype.invoke=function(){return t.isSubWindow()},e}(),o=function(){function n(e){this.storage=e}return Object.defineProperty(n,"IN_SUB_WINDOW_KEY",{get:function(){return"inSubWindow"},enumerable:!1,configurable:!0}),n.prototype.invoke=function(){return!(!this.getInSubWindow()&&!this.getSubWindowIdentifier())||!!new URLSearchParams(window.location.search).has(e.SUB_WINDOW_IDNTIFICATION_KEY)&&(this.setInSubWindow(!0),!0)},n.prototype.getInSubWindow=function(){var t=this.storage.getItem(e.STORE_KEY+":"+this.getLiffId()+":"+n.IN_SUB_WINDOW_KEY);return null!==t&&JSON.parse(t)},n.prototype.getSubWindowIdentifier=function(){var e,t,i="liff.subwindow.identifier",n=new URLSearchParams(window.location.search);return n.get(i)||(e=i,(t=n.get("liff.state"))?new URLSearchParams(t).get(e):null)||null},n.prototype.setInSubWindow=function(t){this.storage.setItem(e.STORE_KEY+":"+this.getLiffId()+":"+n.IN_SUB_WINDOW_KEY,String(t))},n.prototype.getLiffId=function(){var n=i.getConfig().liffId;if(!n)throw t.createLiffError(e.INVALID_CONFIG,"liffId is necessary for liff.init()");return n},n}(),u=function(){function e(){n.isInClient()?this.impl=new r:this.impl=new o(window.sessionStorage)}return Object.defineProperty(e.prototype,"name",{get:function(){return"isSubWindow"},enumerable:!1,configurable:!0}),e.prototype.install=function(){return this.impl.invoke.bind(this.impl)},e}(),f=new u,s=f.install();exports.IsSubWindowModule=u,exports.isSubWindow=s,exports.module=f;
